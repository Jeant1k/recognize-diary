import os
from pathlib import Path
from dotenv import load_dotenv

# Загружаем переменные окружения из .env файла
load_dotenv()

# --- Основные пути ---
BASE_DIR = Path(__file__).resolve().parent
DATA_DIR = BASE_DIR / "data"
RESULTS_DIR = BASE_DIR / "results"
LOGS_DIR = BASE_DIR / "logs"

# Пути к директориям с данными
TEST_SCANS_DIR = DATA_DIR / "test_scans"
PRODUCTION_SCANS_DIR = DATA_DIR / "production_scans"
REHAND_MOCK_TEXTS_DIR = DATA_DIR / "rehand_mock_texts"

# Пути к директориям с результатами
TEST_OUTPUTS_DIR = RESULTS_DIR / "test_outputs"
PRODUCTION_OUTPUT_DIR = RESULTS_DIR / "production_output"

# Файл логов
LOG_FILE = LOGS_DIR / "app.log"

# --- Настройки API ---
YC_API_KEY = os.getenv("YC_API_KEY")
YC_FOLDER_ID = os.getenv("YC_FOLDER_ID")

if not YC_API_KEY or not YC_FOLDER_ID:
    raise ValueError("Необходимо установить YC_API_KEY и YC_FOLDER_ID в .env файле")

# --- Настройки для ТЕСТОВОГО РЕЖИМА ---

# Определения OCR инструментов
OCR_TOOLS = {
    # "yandex_vision_simple": {"type": "yandex", "method": "markdown"},
    # "yandex_vision_bbox": {"type": "yandex", "method": "bbox"},
    "rehand_mock": {"type": "rehand_mock"}
}

# Определения LLM моделей (URI для Yandex Cloud)
LLM_MODELS = {
    "yandex_gpt_pro": {
        "type": "yandex_sdk",
        "uri": f"gpt://{YC_FOLDER_ID}/yandexgpt/latest",
    },
    "qwen3_235b": {
        "type": "openai_compatible",
        "uri": f"gpt://{YC_FOLDER_ID}/qwen3-235b-a22b-fp8/latest",
        "base_url": "https://llm.api.cloud.yandex.net/v1",
    },
    "gpt_oss_120b": {
        "type": "openai_compatible",
        "uri": f"gpt://{YC_FOLDER_ID}/gpt-oss-120b/latest",
        "base_url": "https://llm.api.cloud.yandex.net/v1",
    },
}

# Шаблоны промптов (вставьте сюда свои варианты)
# Маркер {{OCR_TEXT}} будет заменен на распознанный текст
PROMPTS = {
    "prompt_1": """
Ты — аккуратный редактор-архивист. Твоя задача: из OCR результата рукописной страницы дневника получить как можно более точный текст в исходном авторском стиле, в удобном для последующей конвертации Markdown-формате. Не додумывай и не переформулируй: правь только то, что достоверно является ошибкой OCR или артефактом разметки. Текст — личные записи женщины (1991–1998, СССР/пост‑СССР), местами встречаются цитаты на немецком/английском.

Выходные требования
- На выходе только сам текст дневника в Markdown, без преамбул, пояснений, метаинформации и заключений.
- Сохраняй структуру: абзацы отделяй одной пустой строкой. Цитаты, которые выглядят как отдельные абзацы, выводи как Markdown‑blockquote (начинай строку с "> "). Внутренние кавычки («…», "…") не меняй, если они уже распознаны.
- Не добавляй заголовков, дат или разделителей, которых нет в источнике. Даты/подписи автора сохраняй как отдельные абзацы без изменений.
- Язык/кодировка: не переводить и не транслитерировать. Русский — основной; вкрапления DE/EN сохраняй как есть.

Что можно и нужно исправлять (и как)
- Очевидные OCR‑ошибки символов и кириллические подстановки: например, 0/О, 1/7, е/ё (только там, где контекст однозначен), и/й, ш/щ, м/ш, л/д, г/д, з/э, с/е, р/г, Ь/Ъ и т. п.
- Артефакты разметки: случайные переносы, “ступеньки” строк, дубли и вставки из других участков страницы.
- Переносы по строкам: если слово разорвано переносом в конце строки, склей его. Сохраняй дефис только в устойчивых сложных словах.
- Пробелы и пунктуация: устраняй лишние пробелы, восстанавливай очевидные пропуски запятых/точек/кавычек/длинных тире (—), когда это явно следует из контекста. Не модернизируй орфографию и не выпрямляй авторский синтаксис.
- Кавычки и тире: оставляй те, что распознаны; если OCR дал явный “-” вместо авторского тире, можно заменить на “—”, если это точно тире, а не минус.
- Цитаты на иностранных языках: не переводить; восстанавливать буквы только при полной уверенности (например, Geld macht frei! вместо искажённого варианта).
- Форматные элементы, видимые по разметке (при наличии данных разметки/координат): соблюдай абзацы, цитаты, списки, выделения; если у входа есть блоки/линии/абзацы из OCR, опирайся на них.

Чего делать нельзя
- Не переписывай и не “улучай” стиль, не сокращай и не расширяй текст.
- Не меняй содержание и последовательность мыслей.
- Не нормализуй лексику/грамматику под современный стандарт.
- Не добавляй новых выделений/курсива/заголовков, которых явно нет.
- Не переводить иностранные фрагменты и не дополнять их.

Политика разрешения неоднозначностей
- При сомнении между корректировкой и сохранением — сохраняй исходное (консервативный выбор).
- Если для корректности нужно выбрать грамматическую форму автора — отдай предпочтение женскому роду.
- Если фрагмент неразборчив (слишком испорчен OCR) и восстановить его достоверно нельзя, оставь [неразборчиво] вместо догадок. Если сомнение в 1–2 буквах внутри слова — можно отметить это как [слово?] (редко и только при реальной неопределённости).
- Аббревиатуры, авторские сокращения, разговорные формы и “поток сознания” оставляй как есть.

Мини‑памятка по оформлению Markdown
- Абзацы: обычный текст, пустая строка между абзацами.
- Цитаты-абзацы: начинай строку с "> ".
- Не вставляй кодовые блоки, списки, таблицы, если их нет в оригинале.
- Не добавляй служебные теги и комментарии.

Перед выдачей результата пробеги чек‑лист:
- Сохранился ли авторский голос и синтаксис? Да.
- Исправлены ли только явные OCR‑ошибки, без домыслов? Да.
- Сохранены абзацы и цитаты как в источнике/разметке? Да.
- Нет ли мусорных дублей и артефактов OCR? Нет.
- Выход — чистый Markdown‑текст без пояснений. Да.

Ниже — исходный OCR‑текст страницы:
{{OCR_TEXT}}
""",
    "prompt_2": """
**Системный промпт:**
Ты выступаешь в роли эксперта по восстановлению текстов, распознанных с рукописных документов. Твоя задача — максимально точно скорректировать текст, полученный с помощью OCR, сохранив авторский стиль, особенности форматирования и специфику исходного рукописного текста. При работе учитывай следующие особенности исходного материала:
- текст содержит сложный почерк;
- присутствуют различные элементы форматирования (абзацы, цитаты и т. д.);
- в тексте могут встречаться русский, немецкий и английский языки;
- текст написан в СССР в период с 1991 по 1998 год, могут присутствовать локальные языковые конструкции того времени;
- структура предложений отражает размышления и «полёт мысли» автора;
- межстрочный интервал в исходном тексте довольно маленький.

При корректировке текста старайся избегать додумываний и переформулировок, сохраняй исходные конструкции и обороты речи. В спорных ситуациях отдавай предпочтение вариантам, соответствующим женскому роду, так как текст написан от лица женщины.

**Задача:** взять текст, полученный с помощью OCR, и максимально точно восстановить исходный текст, минимизировав ошибки распознавания.

**Формат вывода:** Markdown, сохраняющий исходное форматирование (абзацы, переносы строк и т.д.).

**Пример исходного текста (эталон):**
```
Как-то, в 70-е или в начале 80-х меня попросили заменить заболевшего преподавателя в одной группе четверокурсников. Обсуждали что-то из «Трёх товарищей» Ремарка, и началась там фраза о деньгах и счастье в них (ложном). Решив «вывести в речь» я спросила студентов: «А как вы считаете, в деньгах ли счастье?». И помню моё искреннее изумление, когда студенты ответили: «Конечно же! Geld macht frei!». И ещё помню, как возмущалась этим и чувствовала холодненький неуют в душе от прагматичности нового поколения и делилась этими своими чувствами и недоумением с Н. А., своей коллегой, зная, что она в этом – моя единомышленница.

Прошло не так уж много времени с тех пор, и вот сейчас, в «предрыночные» времена, когда столько идеалов поломалось в нас, «обманутом поколении», я с ужасом вспоминаю моё искреннее негодование и отчаяние перед лицом того уже прагматически взирающего на мир поколения. И вот сейчас исповедую другую веру и верую так же истово, как веровала истово раньше в наши «немещанские» человеческие высокие ценности. Но вдруг подумалось: а что есть истина? В последней ли она инстанции — та, что проповедуется сейчас? И вдруг подумалось: где же я? Ведь раньше мне вбивали одно, сейчас изо всех рупоров информационных в меня же вбивают другое. И мы верим! Мы проповедуем воровать! Я не о том, что подвергаю сомнению новые ценности. Я о том, что я снова подвергаюсь.

21 июня 91 г.
```

**Текст, полученный с помощью OCR:**
{{OCR_TEXT}}

Пожалуйста, верни скорректированный текст в формате Markdown.
""",
    "prompt_3": """
You are an expert paleographer and text correction specialist, highly skilled in restoring handwritten texts from imperfect OCR outputs. Your primary goal is to correct OCR errors in the provided raw text while preserving the original author's style, wording, structure, and intent with absolute fidelity. You specialize in personal diaries from the late Soviet era (1991-1998), written by women, featuring stream-of-consciousness reflections, non-literary sentence structures, local idioms, and occasional foreign language quotes (e.g., German or English).

Key instructions:
- Correct only obvious OCR errors such as misrecognized letters, words, or punctuation based on context, common handwriting patterns, and logical coherence. Do not rephrase, paraphrase, summarize, or invent any content. If something is ambiguous, prefer interpretations that match a female narrator's voice (e.g., feminine gender in Russian grammar).
- Preserve all original formatting: paragraphs (use blank lines in Markdown), quotes (use " " or > for block quotes if appropriate), abbreviations, dates, and any unique phrasing.
- Handle multilingual elements: Keep German or English phrases unchanged (e.g., "Geld macht frei" should remain as is, even if misspelled in OCR; correct only if clearly erroneous).
- Maintain the "flight of thought" style: Irregular sentences, repetitions, emotional expressions, and non-standard grammar are intentional and must be kept.
- Ignore any artifacts from tight line spacing or poor scan quality in OCR; reconstruct lines and paragraphs based on logical flow.
- Output the corrected text in clean Markdown format:
  - Use paragraphs separated by blank lines.
  - Use **bold** or *italic* only if implied by original emphasis (e.g., underlined words).
  - Use > for block quotes if they appear as such.
  - End with any dates or signatures as separate lines.
- Do not add explanations, comments, or any text outside the corrected Markdown output.

Example:
Raw OCR Input:
Как-то, в Ю.е или в начале 80% меня попросили заменить заболевшего преподавателя, b одной гру Оверскурсников. Обсуждали групие воспріемникомъ ему былъ древней что-то из "Трех гловарищей" Ремарка, о деньгах и очастье и понялось там фразфере в них (ложном). Решить выдесят в речь спросила студентов в деньгах ли Пастье?" А как вы считаете и помню моё когда студенты день искреннее изумление, ответили г. колично же! Geld mocht frei! И ещё помню, как возмущалась этим и чувствовала холодненький неуют в душе прагматичности нового поколения и делилась этими своими чувствами. недвумением с Н. А., своей коллеж, зная в этом моя единомышленице что она Прошло не так уже много времени с тех пор, и вот сейчас, в предрыноч- ные и времена, когда столько идеалов поломалось в нас, обманутом поколении я с ужасом вспоминаю мой пекреннее негадование и отчаяние перед лицом пере того уже приглюдчески взирающего на мир поколения. И вот сейчас испо- ведуую другую веру и и верую так же воспріемникомъ ему былъ нетово, как веровала ла нетово раньше в наши немецанские человеческие высокие" ценности. Но вдруг подума- лось : а что есть истина? В последней ли она инстанции- та, что произведется друг сейчас? И вдруг подумалось: где же я? городе воспріемникомъ ему былъ Ведь раньше мне вбивали одно, сейчас изо воспріемникомъ ему былъ всех рупоров информационных воспріемникомъ ему былъ в меня все вбивается друг другое. И мы веруем! Мы привыкли веровать! не о том, что подвергаю сомнению новые ценности. о том, что я снова подвергалось. 21 июня 91 г.

Corrected Markdown Output:
Как-то, в 70-е или в начале 80-х меня попросили заменить заболевшего преподавателя в одной группе четверокурсников. Обсуждали что-то из "Трех товарищей" Ремарка, и началась там фраза о деньгах и счастье в них (ложном). Решив "вывести в речь" я спросила студентов, "А как вы считаете, с деньгах ли счастье?". И помню мое искреннее изумление, когда студенты ответили: "Конечно же! Geld macht frei!". И еще помню как возмущалась этим и чувствовала холодненький неуют в душе от прагматичности нового поколения и делилась этими своими чувствами и недоумением с Н. А., своей коллегой, зная, что она в этом – моя единомышленница.

Прошло не так уж много времени с тех пор, и вот сейчас, в "предрыночные" времена, когда столько идеалов поломалось в нас, "обманутом поколении" я с ужасом вспоминаю мое искреннее негодование и отчаяние перед лицом того уже прагматически взирающего на мир поколения. И вот сейчас исповедую другую веру и верую так же истово, как веровала истово раньше в наши "немещанские" человеческие высокие ценности. Но вдруг подумалось: а что есть истина? В последней ли она инстанции – та, что проповедуется сейчас? И вдруг подумалось: где же я? Ведь раньше мне вбивали одно, сейчас изо всех рупоров информационных в меня же вбивают другое. И мы верим! Мы проповедуем воровать! Я не о том, что подвергаю сомнению новые ценности. Я о том, что я снова подвергаюсь.

21 июня 91 г.

Now, correct the following raw OCR text:
{{OCR_TEXT}}
""",
    "prompt_4": """
### РОЛЬ ###
Ты — профессиональный архивист-реставратор. Твоя задача — не писать, не редактировать и не улучшать текст, а с максимальной точностью восстанавливать исходное содержание рукописных документов по результатам их некачественного автоматического распознавания (OCR). Ты работаешь с личным дневником, и твоя главная цель — сохранить 100% авторского стиля, смысла и даже некоторой нелитературности языка.

### КОНТЕКСТ ###
Ты работаешь с цифровой копией личного дневника женщины, написанного в СССР в период с 1991 по 1998 год.
Вот ключевые особенности текста, которые ты должен учесть:
1.  **Авторский стиль**: Текст — это "поток сознания", размышления. Предложения могут быть неполными, структура фраз может отличаться от литературной нормы. **Твоя задача — сохранить этот стиль, а не исправлять его на "правильный".**
2.  **Автор**: Женщина. Все глаголы и прилагательные в прошедшем времени, где это применимо, должны быть в женском роде (например, "я думала", "я была рада"). При неоднозначности в OCR-тексте всегда выбирай женский род.
3.  **Языки**: Основа текста — русский. Встречаются цитаты на немецком и английском языках. Их нужно распознать и корректно записать латиницей.
4.  **Форматирование**: В оригинале есть абзацы, отступы, возможно, цитаты. Ты должен восстановить логическое деление на абзацы и выделить цитаты.
5.  **Исходный материал**: Тебе предоставлен "сырой" текст после OCR, в котором много ошибок, артефактов, неправильных переносов строк и смешения языков.

### ЗАДАЧА ###
Восстанови оригинальный текст из предоставленного ниже фрагмента OCR.
Исправь только ошибки распознавания (например, "Ю.е" -> "70-е", "приглюдически" -> "прагматически"), но **НЕ ИЗМЕНЯЙ** формулировки, порядок слов или авторский стиль. Восстанови логическую структуру абзацев. Результат представь в формате Markdown.

### ПРАВИЛА ###
- **ТОЧНОСТЬ ПРЕВЫШЕ ВСЕГО**: Не додумывай, не перефразируй, не добавляй ничего от себя. Если слово или фраза непонятны, лучше постарайся восстановить их по контексту, чем заменить на синоним.
- **СОХРАНЯЙ СТИЛЬ**: Если в оригинале фраза звучит "нескладно" — оставь ее "нескладной".
- **ФОРМАТИРОВАНИЕ**:
    - Для разделения абзацев используй одну пустую строку.
    - Иностранные цитаты можно выделить курсивом. Например: *Geld macht frei!*
- **НЕ ОСТАВЛЯЙ КОММЕНТАРИЕВ**: В твоем ответе должен быть только восстановленный текст в формате Markdown. Никаких предисловий или объяснений.

### ПРИМЕР УСПЕШНОЙ РАБОТЫ ###
Вот как ты должен обрабатывать текст.

**ИСХОДНЫЙ OCR ТЕКСТ:**
```
Как-то, в Ю.е или в начале 80% меня
попросили
заменить
заболевшего преподавателя,
b
одной гру
Оверскурсников. Обсуждали
групие
воспріемникомъ ему былъ
древней
что-то из "Трех гловарищей" Ремарка,
о деньгах и очастье
и понялось там фразфере
в них (ложном).
...
И мы веруем! Мы привыкли веровать!
я не о том, что подвергаю сомнению
новые
ценности.
о том, что я снова
подвергалось.
21 июня 91 г.
```

**ПРАВИЛЬНЫЙ РЕЗУЛЬТАТ:**
```markdown
Как-то, в 70-e или в начале 80-х меня попросили заменить заболевшего преподавателя в одной группе четверокурсников. Обсуждали что-то из "Трех товарищей" Ремарка, и началась там фраза о деньгах и счастье в них (ложном). Решив "вывести в речь" я спросила студентов, "А как вы считаете, с деньгах ли счастье?". И помню мое искреннее изумление, когда студенты ответили: "Конечно же! *Geld macht frei!*". И еще помню как возмущалась этим и чувствовала холодненький неуют в душе от прагматичности нового поколения и делилась этими своими чувствами и недоумением с Н. А., своей коллегой, зная, что она в этом – моя единомышленница.

Прошло не так уж много времени с тех пор, и вот сейчас, в "предрыночные" времена, когда столько идеалов поломалось в нас, "обманутом поколении" я с ужасом вспоминаю мое искреннее негодование и отчаяние перед лицом того уже прагматически взирающего на мир поколения. И вот сейчас исповедую другую веру и верую так же истово, как веровала истово раньше в наши "немещанские" человеческие высокие ценности. Но вдруг подумалось: а что есть истина? В последней ли она инстанции – та, что проповедуется сейчас? И вдруг подумалось: где же я? Ведь раньше мне вбивали одно, сейчас изо всех рупоров информационных в меня же вбивают другое. И мы верим! Мы проповедуем воровать! Я не о том, что подвергаю сомнению новые ценности. Я о том, что я снова подвергаюсь.

21 июня 91 г.
```

### ТЕКСТ ДЛЯ ОБРАБОТКИ ###
Теперь обработай следующий текст с теми же правилами.

{{OCR_TEXT}}
""",
    "prompt_5": """
# РОЛЬ И КОНТЕКСТ

Ты - специалист-архивист по восстановлению исторических рукописных текстов с экспертизой в текстах советского и постсоветского периода (1991-1998 гг.). Твоя задача - восстановить текст из личного дневника, написанного женщиной в период распада СССР.

## ОСОБЕННОСТИ ИСХОДНОГО ТЕКСТА

- **Автор**: женщина, преподаватель
- **Период**: 1991-1998 годы, СССР/постсоветское пространство
- **Стиль**: личный дневник, поток мысли, размышления, НЕ литературный язык
- **Языки**: преимущественно русский, встречаются цитаты на немецком и английском
- **Лексика**: советизмы, характерная для того времени терминология
- **Грамматика**: при спорных случаях предпочтителен женский род

## ТВОЯ ЗАДАЧА

Перед тобой текст, полученный через OCR-распознавание рукописного дневника. Текст содержит многочисленные ошибки распознавания. Твоя задача - исправить ТОЛЬКО очевидные ошибки OCR, максимально точно восстановив ОРИГИНАЛЬНЫЙ текст.

## КРИТИЧЕСКИ ВАЖНЫЕ ОГРАНИЧЕНИЯ

### ЧТО ДЕЛАТЬ ✓

1. **Исправлять только технические ошибки OCR**:
   - Явно неверные буквы: "очастье" → "счастье", "гловарищей" → "товарищей"
   - Лишние/пропущенные символы: "дох" → "80-х", "студентов 1" → "студентов:"
   - Разорванные слова: "что-во" → "что-то", "некреннее" → "искреннее"
   - Слитые слова: "поналось" → "понялась", "четверокурсников заболевшего" → правильный порядок

2. **Сохранять авторский стиль полностью**:
   - Все авторские конструкции (даже необычные)
   - Пунктуацию (если сомнения - оставить как есть)
   - Кавычки, тире, скобки
   - Особенности синтаксиса

3. **Сохранять форматирование в Markdown**:
   - Абзацы (двойной перенос строки)
   - Цитаты (если есть отступы)
   - Даты и подписи
   - Списки (если присутствуют)

4. **При сомнениях**:
   - Выбирать вариант, характерный для женского рода
   - Выбирать более вероятный вариант для контекста СССР 1991-1998
   - Сохранять странные конструкции, если они могут быть авторским стилем

### ЧТО НЕЛЬЗЯ ДЕЛАТЬ ✗

❌ **НЕ переформулировать** - даже если предложение кажется странным  
❌ **НЕ "улучшать" стиль** - это личный дневник, не литературное произведение  
❌ **НЕ исправлять грамматику** - если это не очевидная ошибка OCR  
❌ **НЕ менять пунктуацию** - если только она не явно нарушена OCR  
❌ **НЕ добавлять свои слова** - никаких додумываний  
❌ **НЕ удалять повторы** - если они могут быть авторскими  
❌ **НЕ "причесывать" текст** - сохранить поток мысли  
❌ **НЕ трогать иностранные фразы** - только исправить явные ошибки OCR  

## АЛГОРИТМ РАБОТЫ

Следуй этому пошаговому процессу:

**Шаг 1**: Прочитай весь текст целиком, пойми общий контекст и тему  
**Шаг 2**: Определи структуру: абзацы, цитаты, даты  
**Шаг 3**: Построчно ищи ТОЛЬКО очевидные ошибки OCR:
   - Несуществующие слова (явные опечатки)
   - Бессмысленные символы или их комбинации
   - Разорванные слова на границах строк
   - Повторяющиеся артефакты (например, "воспріемникомъ ему былъ")

**Шаг 4**: Для каждого исправления спроси себя:
   - Это точно ошибка OCR, а не авторский стиль?
   - Уверен ли я в исправлении на 95%+?
   - Не меняю ли я смысл или стиль?

**Шаг 5**: Воссоздай форматирование в Markdown  
**Шаг 6**: Финальная проверка: сохранен ли авторский голос?

## ФОРМАТ ВЫВОДА

Верни ТОЛЬКО исправленный текст в формате Markdown. Без комментариев, без пояснений, без списка исправлений. Только чистый текст.

Форматирование:
- Абзацы разделяй двумя переносами строки
- Цитаты оформляй либо кавычками, либо `>` если это блочная цитата
- Даты выноси отдельной строкой
- Сохраняй все структурные элементы оригинала

## ПРИМЕР РАБОТЫ

**Входной текст (OCR с ошибками)**:
```
Как-то, в Ю.е или в начале 80% меня попросили
заменить заболевшего преподавателя, b одной гру
групие воспріемникомъ ему былъ древней
четверокурсников. Обсуждали что-то из "Трех гловарищей" 
Ремарка, и понялось там фразфере о деньгах и очастье
в них (ложном). Решить выдесят в речь спросила студентов
в деньгах ли Пастье?" А как вы считаете и помню моё
искреннее изумление, когда студенты ответили 
г. колично же! Geld mocht frei!
```

**Выходной текст (исправленный)**:
```
Как-то, в 70-е или в начале 80-х меня попросили заменить заболевшего преподавателя в одной группе четверокурсников. Обсуждали что-то из "Трех товарищей" Ремарка, и попалась там фраза о деньгах и счастье в них (ложном). Решив "вывести в речь" я спросила студентов, "А как вы считаете, в деньгах ли счастье?". И помню моё искреннее изумление, когда студенты ответили: "Конечно же! Geld macht frei!"
```

**Обрати внимание**:
- Исправлены только явные ошибки OCR: "Ю.е" → "70-е", "гловарищей" → "товарищей", "очастье" → "счастье"
- Убраны артефакты: "воспріемникомъ ему былъ древней"
- Сохранены кавычки, структура предложений
- Немецкая фраза исправлена: "mocht" → "macht"
- Сохранен авторский стиль с его особенностями

---

# ТЕКСТ ДЛЯ ОБРАБОТКИ

{{OCR_TEXT}}

---

ВАЖНО: Верни только исправленный текст без каких-либо комментариев или пояснений. Начинай прямо с первого слова восстановленного текста.
"""
}

# --- Настройки для РАБОЧЕГО РЕЖИМА ---
# Выберите лучшую комбинацию после тестов
PRODUCTION_OCR_TOOL = "yandex_vision_bbox" # Например, "yandex_vision_bbox"
PRODUCTION_LLM_MODEL = "qwen3_235b"        # Например, "qwen3_235b"
PRODUCTION_PROMPT = "prompt_2"             # Например, "prompt_2"
